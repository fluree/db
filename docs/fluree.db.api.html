<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fluree.db.api documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">com.fluree/db</span> <span class="project-version">3.0.0-alpha2</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="fluree.db.api.html"><div class="inner"><span>fluree.db.api</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fluree.db.api.html#var-address.3F"><div class="inner"><span>address?</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-alias-.3Eaddress"><div class="inner"><span>alias-&gt;address</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-commit.21"><div class="inner"><span>commit!</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-connect"><div class="inner"><span>connect</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-connect-file"><div class="inner"><span>connect-file</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-connect-memory"><div class="inner"><span>connect-memory</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-convert-config-key"><div class="inner"><span>convert-config-key</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-convert-keys"><div class="inner"><span>convert-keys</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-create-with-txn"><div class="inner"><span>create-with-txn</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-credential-history"><div class="inner"><span>credential-history</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-credential-query"><div class="inner"><span>credential-query</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-credential-query-connection"><div class="inner"><span>credential-query-connection</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-credential-transact.21"><div class="inner"><span>credential-transact!</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-dataset"><div class="inner"><span>dataset</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-db"><div class="inner"><span>db</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-decode-iri"><div class="inner"><span>decode-iri</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-disconnect"><div class="inner"><span>disconnect</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-drop"><div class="inner"><span>drop</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-encode-iri"><div class="inner"><span>encode-iri</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-exists.3F"><div class="inner"><span>exists?</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-expand-iri"><div class="inner"><span>expand-iri</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-format-txn"><div class="inner"><span>format-txn</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-history"><div class="inner"><span>history</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-insert"><div class="inner"><span>insert</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-load"><div class="inner"><span>load</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-notify"><div class="inner"><span>notify</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-promise-wrap"><div class="inner"><span>promise-wrap</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-query-connection"><div class="inner"><span>query-connection</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-range"><div class="inner"><span>range</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-reason"><div class="inner"><span>reason</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-reasoned-count"><div class="inner"><span>reasoned-count</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-reasoned-facts"><div class="inner"><span>reasoned-facts</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-slice"><div class="inner"><span>slice</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-stage"><div class="inner"><span>stage</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-status"><div class="inner"><span>status</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-transact.21"><div class="inner"><span>transact!</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-update"><div class="inner"><span>update</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-upsert"><div class="inner"><span>upsert</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-wrap-class-policy"><div class="inner"><span>wrap-class-policy</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-wrap-identity-policy"><div class="inner"><span>wrap-identity-policy</span></div></a></li><li class="depth-1"><a href="fluree.db.api.html#var-wrap-policy"><div class="inner"><span>wrap-policy</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fluree.db.api</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-address.3F"><h3>address?</h3><div class="usage"><code>(address? ledger-alias-or-address)</code></div><div class="doc"><pre class="plaintext">Returns true if the argument is a full ledger address, false if it is just an
alias.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L139">view source</a></div></div><div class="public anchor" id="var-alias-.3Eaddress"><h3>alias-&gt;address</h3><div class="usage"><code>(alias-&gt;address conn ledger-alias)</code></div><div class="doc"><pre class="plaintext">Returns a core.async channel with the connection-specific address of the
given ledger-alias.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L171">view source</a></div></div><div class="public anchor" id="var-commit.21"><h3>commit!</h3><div class="usage"><code>(commit! ledger db)</code><code>(commit! ledger db opts)</code></div><div class="doc"><pre class="plaintext">Commits a staged database to the ledger with all changes since the last commit
aggregated together.

Commits are tracked in the local environment, but if the ledger is distributed
it will still need a 'push' to ensure it is published and verified as per the
distributed rules.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L279">view source</a></div></div><div class="public anchor" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect config)</code></div><div class="doc"><pre class="plaintext">Forms connection to ledger, enabling automatic pulls of new updates, event
services, index service.

Multiple connections to same endpoint will share underlying network
connection.

Options include:
  - did - (optional) DId information to use, if storing blocks as verifiable
          credentials, or issuing queries against a permissioned database.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L51">view source</a></div></div><div class="public anchor" id="var-connect-file"><h3>connect-file</h3><div class="usage"><code>(connect-file)</code><code>(connect-file {:keys [storage-path parallelism cache-max-mb defaults], :or {storage-path "data", parallelism 4, cache-max-mb 1000}})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L117">view source</a></div></div><div class="public anchor" id="var-connect-memory"><h3>connect-memory</h3><div class="usage"><code>(connect-memory)</code><code>(connect-memory {:keys [parallelism cache-max-mb defaults], :or {parallelism 4, cache-max-mb 1000}})</code></div><div class="doc"><pre class="plaintext">Forms an in-memory connection using default settings.
- did - (optional) DId information to use, if storing blocks as verifiable credentials</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L94">view source</a></div></div><div class="public anchor" id="var-convert-config-key"><h3>convert-config-key</h3><div class="usage"><code>(convert-config-key [k v])</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L78">view source</a></div></div><div class="public anchor" id="var-convert-keys"><h3>convert-keys</h3><div class="usage"><code>(convert-keys m)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L86">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create conn ledger-alias)</code><code>(create conn ledger-alias opts)</code></div><div class="doc"><pre class="plaintext">Creates a new json-ld ledger. A connection (conn)
must always be supplied.

Ledger-name (optional) is a friendly name that is used for:
- When publishing to a naming service that allows multiple pointers for the
  same namespace (e.g. IPNS), this becomes a sub-directory off the namespace.
  For multple directories deep, use '/' for a
  e.g. the ledgers movies/popular, books/authors, books/best-sellers could
  use the same IPNS id (in this example using IPNS DNSLink):
  fluree:ipns://my.dns.com/books/authors
  fluree:ipns://my.dns.com/books/best-sellers
  fluree:ipns://my.dns.com/movies/top-rated
- When combining multiple ledgers, each ledger becomes an individual named
  graph which can be referenced by name.

Options map (opts) can include:
- did - DId information to use, if storing blocks as verifiable credentials</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L145">view source</a></div></div><div class="public anchor" id="var-create-with-txn"><h3>create-with-txn</h3><div class="usage"><code>(create-with-txn conn txn)</code><code>(create-with-txn conn txn opts)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L307">view source</a></div></div><div class="public anchor" id="var-credential-history"><h3>credential-history</h3><div class="usage"><code>(credential-history ledger cred-query)</code><code>(credential-history ledger cred-query override-opts)</code></div><div class="doc"><pre class="plaintext">Issues a policy-enforced history query to the specified ledger as a
verifiable credential.

Extracts the query from the credential, and cryptographically verifies the
signing identity, which is then used by `wrap-identity-policy` to extract
the policy classes and apply the policies to the query.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L445">view source</a></div></div><div class="public anchor" id="var-credential-query"><h3>credential-query</h3><div class="usage"><code>(credential-query ds cred-query)</code><code>(credential-query ds cred-query {:keys [values-map format], :as opts})</code></div><div class="doc"><pre class="plaintext">Issues a policy-enforced query to the specified dataset/db as a verifiable
credential.

Extracts the query from the credential, and cryptographically verifies the
signing identity, which is then used by `wrap-identity-policy` to extract
the policy classes and apply the policies to the query.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L397">view source</a></div></div><div class="public anchor" id="var-credential-query-connection"><h3>credential-query-connection</h3><div class="usage"><code>(credential-query-connection conn cred-query)</code><code>(credential-query-connection conn cred-query {:keys [format], :as opts})</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L424">view source</a></div></div><div class="public anchor" id="var-credential-transact.21"><h3>credential-transact!</h3><div class="usage"><code>(credential-transact! conn txn)</code><code>(credential-transact! conn txn opts)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L300">view source</a></div></div><div class="public anchor" id="var-dataset"><h3>dataset</h3><div class="usage"><code>(dataset named-graphs)</code><code>(dataset named-graphs default-graphs)</code></div><div class="doc"><pre class="plaintext">Creates a composed dataset from multiple resolved graph databases.

The databases to be composed are supplied as a map with a string alias
as they key, and the resolved graph db as the value.

By default, every resolved graph db will be composed together as a new
default graph which will be used for all where clauses in queries that
do *not* specify a specific graph to target, which is done using the
special `graph` syntax in the where clause.

If just one or more of the supplied graph dbs should instead be used as
the default graph (instead of all of them), supply the second argument
as a list of the db aliases in the db-map that should be used as the
default.

Targeting a single named graph in a query (as opposed to the default graph)
is done by using the `graph` syntax within the 'where' clause, for example:
{...
 'where': [...
           ['graph' &lt;graph-alias&gt; &lt;query-pattern&gt;]]
 ...}</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L362">view source</a></div></div><div class="public anchor" id="var-db"><h3>db</h3><div class="usage"><code>(db ledger)</code></div><div class="doc"><pre class="plaintext">Retrieves latest db, or optionally a db at a moment in time
and/or permissioned to a specific identity.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L324">view source</a></div></div><div class="public anchor" id="var-decode-iri"><h3>decode-iri</h3><div class="usage"><code>(decode-iri db iri)</code></div><div class="doc"><pre class="plaintext">Opposite of encode-iri. When doing more advanced features
like direct range-scans of indexes, IRIs are returned in their
internal compact format. This allows the IRI to be returned
as a full string IRI.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L489">view source</a></div></div><div class="public anchor" id="var-disconnect"><h3>disconnect</h3><div class="usage"><code>(disconnect conn)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L73">view source</a></div></div><div class="public anchor" id="var-drop"><h3>drop</h3><div class="usage"><code>(drop conn ledger-alias)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L186">view source</a></div></div><div class="public anchor" id="var-encode-iri"><h3>encode-iri</h3><div class="usage"><code>(encode-iri db iri)</code></div><div class="doc"><pre class="plaintext">Returns the internal Fluree IRI identifier (a compact form).
This can be used for doing range scans, slices and for other
more advanced needs.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L482">view source</a></div></div><div class="public anchor" id="var-exists.3F"><h3>exists?</h3><div class="usage"><code>(exists? conn ledger-alias-or-address)</code></div><div class="doc"><pre class="plaintext">Returns a promise with true if the ledger alias or address exists, false
otherwise.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L191">view source</a></div></div><div class="public anchor" id="var-expand-iri"><h3>expand-iri</h3><div class="usage"><code>(expand-iri context compact-iri)</code></div><div class="doc"><pre class="plaintext">Expands given IRI with the default database context, or provided context.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L476">view source</a></div></div><div class="public anchor" id="var-format-txn"><h3>format-txn</h3><div class="usage"><code>(format-txn txn override-opts)</code></div><div class="doc"><pre class="plaintext">Reformats the transaction `txn` as JSON-QL if it is formatted as SPARQL,
returning it unchanged otherwise.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L273">view source</a></div></div><div class="public anchor" id="var-history"><h3>history</h3><div class="usage"><code>(history ledger query)</code><code>(history ledger query override-opts)</code></div><div class="doc"><pre class="plaintext">Return the change history over a specified time range. Optionally include the commit
that produced the changes.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L436">view source</a></div></div><div class="public anchor" id="var-insert"><h3>insert</h3><div class="usage"><code>(insert db json-ld)</code><code>(insert db json-ld opts)</code></div><div class="doc"><pre class="plaintext">Inserts a new set of data into the database if valid (does not commit).
Multiple inserts and updates can be staged together and will be merged into a single
transaction when committed.

Supports JSON-LD (default) and Turtle (TTL) formats.

The 'opts' key is a map with the following key options:
 - `:context` - (optional) and externally provided context that will be used
                for JSON-LD document expansition, the @context in the json-ld
                will be ignored if present.
 - `:format`  - (optional) the format of the data, currently json-ld is assumed
               unless `:format` is set to `:turtle`. If `:turtle` is set,
               the `:context` option will be ignored if provided.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L217">view source</a></div></div><div class="public anchor" id="var-load"><h3>load</h3><div class="usage"><code>(load conn alias-or-address)</code></div><div class="doc"><pre class="plaintext">Loads an existing ledger by its alias (which will be converted to a
connection-specific address first).</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L178">view source</a></div></div><div class="public anchor" id="var-notify"><h3>notify</h3><div class="usage"><code>(notify conn commit-address commit-hash)</code></div><div class="doc"><pre class="plaintext">Notifies the connection of a new commit stored at address `commit-address`.

If the connection knows of the ledger, and is currently maintaining an
in-memory version of the ledger, will attempt to update the db if the commit
is for the next 't' value. If a commit is for a past 't' value, noop. If
commit is for a future 't' value, will drop in-memory ledger for reload upon
next request.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L204">view source</a></div></div><div class="public anchor" id="var-promise-wrap"><h3>promise-wrap</h3><div class="usage"><code>(promise-wrap port)</code></div><div class="doc"><pre class="plaintext">Wraps an async channel that will contain a response in a promise.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L24">view source</a></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query ds q)</code><code>(query ds q opts)</code></div><div class="doc"><pre class="plaintext">Queries a dataset or single db and returns a promise with the results.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L388">view source</a></div></div><div class="public anchor" id="var-query-connection"><h3>query-connection</h3><div class="usage"><code>(query-connection conn q)</code><code>(query-connection conn q opts)</code></div><div class="doc"><pre class="plaintext">Queries the latest db in the ledger specified by the 'from' parameter in the
query (what that actually looks like is format-specific). Returns a promise
with the results.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L415">view source</a></div></div><div class="public anchor" id="var-range"><h3>range</h3><div class="usage"><code>(range db index test match)</code><code>(range db index start-test start-match end-test end-match)</code></div><div class="doc"><pre class="plaintext">Performs a range scan against the specified index using test functions
of &gt;=, &lt;=, &gt;, &lt;</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L459">view source</a></div></div><div class="public anchor" id="var-reason"><h3>reason</h3><div class="usage"><code>(reason db methods)</code><code>(reason db methods rule-sources)</code><code>(reason db methods rule-sources opts)</code></div><div class="doc"><pre class="plaintext">Sets the reasoner methods(s) to perform on a db.
Supported methods are :datalog and :owl2rl.
One or more methods can be supplied as a sequential list/vector.

Reasoning is done in-memory at the db-level and is not persisted.

A rules graph containing rules in JSON-LD format can be supplied,
or if no rules graph is supplied, the rules will be looked for within
the db itself.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L499">view source</a></div></div><div class="public anchor" id="var-reasoned-count"><h3>reasoned-count</h3><div class="usage"><code>(reasoned-count db)</code></div><div class="doc"><pre class="plaintext">Returns a count of reasoned facts in the provided db.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L515">view source</a></div></div><div class="public anchor" id="var-reasoned-facts"><h3>reasoned-facts</h3><div class="usage"><code>(reasoned-facts db)</code><code>(reasoned-facts db opts)</code></div><div class="doc"><pre class="plaintext">Returns all reasoned facts in the provided db as  4-tuples of:
[subject property object rule-iri]
where the rule-iri is the @id of the rule that generated the fact

Returns 4-tuples of  where
the rule-iri is the @id of the rule that generated the fact.

NOTE: Currently returns internal fluree ids for subject, property and object.
This will be changed to return IRIs in a future release.

Optional opts map specified grouping, or no grouping (default):
{:group-by :rule} - group by rule IRI
{:group-by :subject} - group by the reasoned triples' subject
{:group-by ::property} - group by the reasoned triples' property IRI</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L520">view source</a></div></div><div class="public anchor" id="var-slice"><h3>slice</h3><div class="usage"><code>(slice db index match)</code></div><div class="doc"><pre class="plaintext">Like range, but returns all flakes that match the supplied flake parts.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L470">view source</a></div></div><div class="public anchor" id="var-stage"><h3>stage</h3><div class="usage"><code>(stage db json-ld)</code><code>(stage db json-ld opts)</code></div><div class="doc"><pre class="plaintext">Renamed to `update`, prefer that API instead.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L268">view source</a></div></div><div class="public anchor" id="var-status"><h3>status</h3><div class="usage"><code>(status ledger)</code><code>(status ledger branch)</code></div><div class="doc"><pre class="plaintext">Returns current status of ledger branch.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L317">view source</a></div></div><div class="public anchor" id="var-transact.21"><h3>transact!</h3><div class="usage"><code>(transact! conn txn)</code><code>(transact! conn txn opts)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L293">view source</a></div></div><div class="public anchor" id="var-update"><h3>update</h3><div class="usage"><code>(update db json-ld)</code><code>(update db json-ld opts)</code></div><div class="doc"><pre class="plaintext">Performs an update and queues change if valid (does not commit).
Multiple updates can be staged together and will be merged into a single
transaction when committed.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L258">view source</a></div></div><div class="public anchor" id="var-upsert"><h3>upsert</h3><div class="usage"><code>(upsert db json-ld)</code><code>(upsert db json-ld opts)</code></div><div class="doc"><pre class="plaintext">Performs an upsert operation, which will insert the data if it does not exist,
or update the existing data if it does. This is useful for ensuring that a
specific document is present in the database with the desired values.

Supports JSON-LD and Turtle (TTL) formats.

The 'opts' key is a map with the following key options:
 - `:context` - (optional) and externally provided context that will be used
                for document expansion, the @context in the json-ld will be 
                ignored if present.
- `:format`  - (optional) the format of the data, currently json-ld is assumed
               unless `:format` is set to `:turtle`. If `:turtle` is set,
               the `:context` option will be ignored if provided.

The data is expected to be in JSON-LD format, and will be expanded before
being inserted into the database.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L236">view source</a></div></div><div class="public anchor" id="var-wrap-class-policy"><h3>wrap-class-policy</h3><div class="usage"><code>(wrap-class-policy db policy-classes)</code><code>(wrap-class-policy db policy-classes policy-values)</code></div><div class="doc"><pre class="plaintext">Restricts the provided db with policies in the db
which have a class @type of the provided class(es).</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L340">view source</a></div></div><div class="public anchor" id="var-wrap-identity-policy"><h3>wrap-identity-policy</h3><div class="usage"><code>(wrap-identity-policy db identity)</code><code>(wrap-identity-policy db identity policy-values)</code></div><div class="doc"><pre class="plaintext">For provided identity, locates specific property f:policyClass on
the identity containing a list of class IRIs that identity the policies
that should be applied to the identity.

With the policy classes, finds all policies containing that class
declaration.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L349">view source</a></div></div><div class="public anchor" id="var-wrap-policy"><h3>wrap-policy</h3><div class="usage"><code>(wrap-policy db policy)</code><code>(wrap-policy db policy policy-values)</code></div><div class="doc"><pre class="plaintext">Restricts the provided db with the provided json-ld
policy restrictions</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha2/src/fluree/db/api.cljc#L330">view source</a></div></div></div></body></html>